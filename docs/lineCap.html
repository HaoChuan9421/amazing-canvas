<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>lineCap</title>
  </head>
  <body>
    <canvas id="canvas" width="400" height="400"></canvas>
  </body>
  <script>
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var n = 0.3;
    initCanvas();
    // 起动动画
    function initCanvas() {
      setInterval(() => {
        ctx.clearRect(0, 0, 400, 400);
        draw(n);
        n += 0.1;
        if (n > 1) {
          n = 0.3;
        }
      }, 100);
    }

    function draw(n) {
      // 圆心坐标
      var center = [50, 50];
      // 线长度和距离圆心距离
      var length = 6,
        offset = 10;
      num = n;
      // 开始绘制
      ctx.lineWidth = 4;
      ctx.lineCap = 'round';
      for (var angle = 0; angle < 360; angle += 45) {
        // 正余弦
        var sin = Math.sin((angle / 180) * Math.PI);
        var cos = Math.cos((angle / 180) * Math.PI);

        ctx.beginPath(); // 开始绘制
        ctx.moveTo(center[0] + offset * cos, center[1] + offset * sin); // 起点
        ctx.lineTo(center[0] + (offset + length) * cos, center[1] + (offset + length) * sin); // 终点

        if (num < 0.3) {
          num = 1;
        }
        ctx.strokeStyle = 'rgba(0,0,0,' + num + ')';
        num -= 0.1;
        ctx.stroke(); //执行绘制
      }
    }
  </script>
</html>
